<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Ganesh Kinkar Giri" /><link rel="canonical" href="https://ganesh-document.github.io/all-documents/AIML/DeepLearning/Tensorflow.html" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Tensorflow - All the documents</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Tensorflow";
        var mkdocs_page_input_path = "AIML/DeepLearning/Tensorflow.md";
        var mkdocs_page_url = "/all-documents/AIML/DeepLearning/Tensorflow.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> All the documents
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Overview</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Documents</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentsdetails.html">Documents details</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AIML</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../aiml-overview.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Supervised</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Supervised/Supervised-overview.html">Supervised Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Regression</a>
    <ul>
                <li class="toctree-l3"><a class="" href="../Supervised/Linear-Regression.md">Linear Regression</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/Decision-Tree.md">Decision Tree</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/Random-Forest.md">Random Forest</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/SVM.md">SVM</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/Naive-Bayes.md">Naive Bayes</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/Gradient-Boosting.md">Gradient Boosting</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Classification</a>
    <ul>
                <li class="toctree-l3"><a class="" href="../Supervised/Classification-overview.md">Classification Overview</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/Logistic-Regression.md">Logistic Regression</a>
                </li>
                <li class="toctree-l3"><a class="" href="../Supervised/KNN.md">KNN</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Unsupervised</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/Unsupervised-overview.html">Unsupervised Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/K-means.html">K-means</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/PCA.html">PCA</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/SOM.html">SOM</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/ARIMA.html">ARIMA</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Unsupervised/SARIMA.html">SARIMA</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Deep Learning</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="DeepLearning-overview.html">Deep Learning Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="DeepLearning-algorithms.html">Deep Learning Algorithms</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Keras.html">Keras</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Tensorflow</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Pytorch.html">Pytorch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="LSTM.html">LSTM</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Autoencoder.html">Autoencoder</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="Reinforcement-Learning.html">Reinforcement Learning</a>
                </li>
                <li class="toctree-l2"><a class="" href="NLP.md">NLP</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="BERT.html">BERT</a>
                </li>
                <li class="toctree-l2"><a class="" href="GPT.md">GPT</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Cloud</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Cloud/Aws/aws.html">Aws</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Azure</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Azure AZ-305</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Azure-all-services.html">Azure All Services</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Compute.html">Compute</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Containers.html">Containers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Analytics.html">Analytics</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Databases.html">Databases</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/DevOps.html">DevOps</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Hybrid-Multicloud.html">Hybrid & Multicloud</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Identity.html">Identity</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Integration.html">Integration</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Internet-of-Things.html">Internet of Things(IoT)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Management-governance.html">Management and governance</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Migration.html">Migration</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Mixed-reality.html">Mixed reality</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Monitor.html">Monitor</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Networking.html">Networking</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Security.html">Security</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Storage.html">Storage</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/Web-Mobile.html">Web & Mobile</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-305/General.html">General</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Azure Security AZ-500</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-500/Azure-Security-Technologies.html">Azure Security Technologies</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-500/Manage-Identity-and-Access.html">Manage Identity and Access</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-500/Implement-platform-protection.html">Implement platform protection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-500/Secure-your-data-and-applications.html">Secure your data and applications</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Cloud/Azure/AZ-500/Manage-security-operation.html">Manage security operation</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Cloud/Gcp/gcp.html">Gcp</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Cloud/Oci/oci.html">Oci</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Cloud/Ibm/ibm.html">Ibm</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Devops</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../Devops/devops-overview.md">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Tools</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Kubernetes</a>
    <ul>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-overview.md">Overview</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Images.md">Kubernetes Images</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Jobs.md">Kubernetes Jobs</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Labels-and-Selectors.md">Kubernetes Labels & Selectors</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Namespace.md">Kubernetes Namespace.md</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/ Kubernetes-Node.md">Kubernetes Node</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Service.md">Kubernetes Service</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Pod.md">Kubernetes Pod</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Replication-Controller.md">Kubernetes Replication Controller</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Replica-Sets.md">Kubernetes Replica Sets</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Deployments.md">Kubernetes Deployments</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Volumes.md">Kubernetes Volumes</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Secrets.md">Kubernetes Secrets</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../Devops/tools/kubernetes/Kubernetes-Network-Policy.md">Kubernetes Network Policy</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >CI (Continuous Integration)</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Github-action.html">Github Action</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Jenkins.html">Jenkins</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/TravisCI.html">TravisCI</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Gitlab.html">GitLab</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/TeamCity.html">TeamCity</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/CircleCI.html">CircleCI</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Bamboo.html">Bamboo</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Bitbucket.html">Bitbucket</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/AWS-CodePipeline.html">AWS CodePipeline</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CI/Azure-Pipelines.html">Azure Pipelines</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >CD (Continuous Delivery)</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CD/Jenkins.html">Jenkins</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CD/ArgoCD.html">ArgoCD</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CD/GoCD.html">GoCD</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CD/Spinnaker.html">Spinnaker</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CD/GitLab.html">GitLab</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >CR (Container Registry)</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CR/Jfrog-artifactory.html">Jfrog artifactory</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >SCR (Source Code Repository)</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/SCR/Github.html">Github</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >CQT (Code Quality Tools)</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Devops/tools/CQT/Sonarqube.html">SonarQube</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Compliance</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Compliance/compliance.html">poc</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DevSecOps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../DevSecOps/DevSecOps.md">DevSecOps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Hashicorp Vault</a>
    <ul>
                <li class="toctree-l2"><a class="" href="../../Security/Hashicorp-vault/Hashicorp-vault.md">Hashicorp Vault details</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Security/Hashicorp-vault/Hashicorp-vault-instalation.md">Hashicorp Vault instalation</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Security/Hashicorp-vault/hashicorp-vault-github-auth.md">Hashicorp Vault github auth</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/ThreatModeling/ThreatModeling.html">Threat Modeling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >SAST</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../DevSecOps/SAST/SAST.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/SonarQube.html">SonarQube</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/snyk.html">snyk</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../DevSecOps/SAST/Tools/Verracode.md">Verracode</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/HCLAppScan.html">HCLAppScan</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/Github.html">Github</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/GitLab.html">GitLab</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/GitGuardian.html">GitGuardian</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/Coverity.html">Coverity</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/Semgrep.html">Semgrep</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/SonarQube.html">SonarQube</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/SonarQube.html">SonarQube</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../DevSecOps/SAST/Tools/Checkmarx.html">Checkmarx</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../DevSecOps/SAST/Tools/Fortify.md">Fortify Static Code Analyzer</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../DevSecOps/SAST/Tools/kiuwan.md">Kiuwan Code Security Insights</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/DAST/dast.html">DAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/SCA/sca.html">SCA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/Containerimagescan/Containerimagescan.html">Container image scan</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/IaC/iac.html">IaC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/OSSC/ossc.html">OSSC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevSecOps/CyberArk/CyberArk.html">CyberArk</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Security</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >CCSP</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Security/CCSP/CCSP-2023-1.html">CCSP-2023-1</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Security/CCSP/CCSP-2023-2.html">CCSP-2023-2</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Security/CCSP/CCSP-2023-3.html">CCSP-2023-3</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../Security/Penetration-Testing/Tools/devsecops-cs.md">Penetration Testing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Microservice</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../MicroService/microservice.html">Microservice</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">All the documents</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">AIML</li>
          <li class="breadcrumb-item">Deep Learning</li>
      <li class="breadcrumb-item active">Tensorflow</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tree/main/all-documents/AIML/DeepLearning/Tensorflow.md">Edit on Ganesh All Documents</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="tf-version-of-the-code"><strong>TF Version of the code</strong><a class="headerlink" href="#tf-version-of-the-code" title="Permanent link">#</a></h2>
<pre><code>import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_regression
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD
from tensorflow.keras.losses import MeanSquaredError
</code></pre>
<pre><code># Generate synthetic data
X, y = make_regression(n_samples=1000, n_features=10, noise=0.1)
y = y.reshape(-1, 1)  # Reshape to match output dimensions

# Split data into training and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Standardize the data
scaler_X = StandardScaler()
scaler_y = StandardScaler()

X_train = scaler_X.fit_transform(X_train)
X_test = scaler_X.transform(X_test)
y_train = scaler_y.fit_transform(y_train)
y_test = scaler_y.transform(y_test)
</code></pre>
<pre><code># Define the model
model = Sequential()
model.add(Dense(units=1, input_dim=X_train.shape[1], activation='linear'))

# Compile the model
model.compile(optimizer=SGD(learning_rate=0.01), loss=MeanSquaredError())
</code></pre>
<pre><code># Train the model
history = model.fit(X_train, y_train, epochs=1000, batch_size=32, verbose=1)
</code></pre>
<pre><code># Evaluate the model
y_pred = model.predict(X_test)
y_pred = scaler_y.inverse_transform(y_pred)
y_test_inverse = scaler_y.inverse_transform(y_test)

# Plot predictions vs actual
plt.scatter(y_test_inverse, y_pred, color='blue')
plt.plot([y_test_inverse.min(), y_test_inverse.max()], [y_test_inverse.min(), y_test_inverse.max()], 'k--', lw=2)
plt.xlabel('Actual')
plt.ylabel('Predicted')
plt.title('Predicted vs Actual')
plt.show()
</code></pre>
<h2 id="tensorflow-version-of-the-code"><strong>Tensorflow version of the code</strong><a class="headerlink" href="#tensorflow-version-of-the-code" title="Permanent link">#</a></h2>
<pre><code># Split data into training and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Standardize the data
scaler_X = StandardScaler()
scaler_y = StandardScaler()

X_train = scaler_X.fit_transform(X_train)
X_test = scaler_X.transform(X_test)
y_train = scaler_y.fit_transform(y_train)
y_test = scaler_y.transform(y_test)

# Convert to TensorFlow tensors
X_train = tf.constant(X_train, dtype=tf.float32)
X_test = tf.constant(X_test, dtype=tf.float32)
y_train = tf.constant(y_train, dtype=tf.float32)
y_test = tf.constant(y_test, dtype=tf.float32)
</code></pre>
<pre><code>model = tf.keras.Sequential([
    tf.keras.layers.Dense(units=1, input_dim=X_train.shape[1], activation='linear')
])
</code></pre>
<pre><code>model.compile(optimizer='sgd', loss='mean_squared_error')
</code></pre>
<pre><code>history = model.fit(X_train, y_train, epochs=1000, batch_size=32, verbose=1)
</code></pre>
<pre><code>y_pred = model.predict(X_test)
y_pred = scaler_y.inverse_transform(y_pred)
y_test_inverse = scaler_y.inverse_transform(y_test)

plt.scatter(y_test_inverse, y_pred, color='blue')
plt.plot([y_test_inverse.min(), y_test_inverse.max()], [y_test_inverse.min(), y_test_inverse.max()], 'k--', lw=2)
plt.xlabel('Actual')
plt.ylabel('Predicted')
plt.title('Predicted vs Actual')
plt.show()
</code></pre>
<pre><code># making it deep using TF
# Split data into training and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Standardize the data
scaler_X = StandardScaler()
scaler_y = StandardScaler()

X_train = scaler_X.fit_transform(X_train)
X_test = scaler_X.transform(X_test)
y_train = scaler_y.fit_transform(y_train)
y_test = scaler_y.transform(y_test)
</code></pre>
<pre><code># Convert to TensorFlow tensors
X_train = tf.constant(X_train, dtype=tf.float32)
X_test = tf.constant(X_test, dtype=tf.float32)
y_train = tf.constant(y_train, dtype=tf.float32)
y_test = tf.constant(y_test, dtype=tf.float32)
</code></pre>
<pre><code># Define the model
model = tf.keras.Sequential([
    tf.keras.layers.Dense(64, input_dim=X_train.shape[1], activation='relu'),
    tf.keras.layers.Dense(32, activation='relu'),
    tf.keras.layers.Dense(16, activation='relu'),
    tf.keras.layers.Dense(1, activation='linear')
])
</code></pre>
<pre><code>model.summary()
</code></pre>
<pre><code># Compile the model
model.compile(optimizer='adam', loss='mean_squared_error')
</code></pre>
<pre><code># Train the model
history = model.fit(X_train, y_train, epochs=100, batch_size=32, verbose=1)
</code></pre>
<pre><code># Evaluate the model
y_pred = model.predict(X_test)
y_pred = scaler_y.inverse_transform(y_pred)
y_test_inverse = scaler_y.inverse_transform(y_test)
</code></pre>
<pre><code># Plot predictions vs actual
plt.scatter(y_test_inverse, y_pred, color='blue')
plt.plot([y_test_inverse.min(), y_test_inverse.max()], [y_test_inverse.min(), y_test_inverse.max()], 'k--', lw=2)
plt.xlabel('Actual')
plt.ylabel('Predicted')
plt.title('Predicted vs Actual')
plt.show()
</code></pre>
<h2 id="refined-intro-to-tf"><strong>Refined Intro to TF</strong><a class="headerlink" href="#refined-intro-to-tf" title="Permanent link">#</a></h2>
<pre><code>import tensorflow as tf
</code></pre>
<pre><code>string = tf.Variable(&quot;this is a string&quot;, tf.string)
string
</code></pre>
<pre><code>string = tf.Variable(&quot;this is a string&quot;, tf.string)
number = tf.Variable(324, tf.int16)
floating = tf.Variable(3.567, tf.float32)
</code></pre>
<pre><code>11*8*8*8*8*8*8*4
</code></pre>
<pre><code>rank1_tensor = tf.Variable([&quot;Test&quot;], tf.string)
rank2_tensor = tf.Variable([[&quot;test&quot;, &quot;ok&quot;], [&quot;test&quot;, &quot;yes&quot;]], tf.string)
</code></pre>
<pre><code>tf.rank(rank1_tensor)
#tf.shape(rank2_tensor)
</code></pre>
<pre><code>t1 = tf.zeros([1,2,3])
t2 = tf.reshape(t1, [2,3,1])
t3 = tf.reshape(t2, [3,-1])
</code></pre>
<pre><code>### Refined Code for TensorFlow 2.x

import tensorflow as tf

# Tensor Creation Examples
string = tf.Variable(&quot;this is a string&quot;, tf.string)
number = tf.Variable(324, tf.int16)
floating = tf.Variable(3.567, tf.float32)

# Tensor Rank Examples
rank1_tensor = tf.Variable([&quot;Test&quot;], tf.string)
rank2_tensor = tf.Variable([[&quot;test&quot;, &quot;ok&quot;], [&quot;test&quot;, &quot;yes&quot;]], tf.string)

# Tensor Shape Examples
print(tf.rank(rank2_tensor))
print(tf.shape(rank2_tensor))

# Reshaping Tensors
t1 = tf.zeros([1,2,3])
t2 = tf.reshape(t1, [2,3,1])
t3 = tf.reshape(t2, [3,-1])

# Placeholder Example (TensorFlow 2.x does not have placeholders)
@tf.function
def func(x):
    return x

output = func(tf.constant('Hello World'))
print(output)

# Placeholder with feed_dict Example (Converted to TensorFlow 2.x)
@tf.function
def func(x, y, z):
    return x, y, z

output_x, output_y, output_z = func(tf.constant('Test String'), tf.constant(123), tf.constant(45.67))
print(output_x)
print(output_y)
print(output_z)

# TensorFlow Math Functions
x = tf.add(5, 2)
y = tf.subtract(10, 4)
z = tf.multiply(2, 5)

# Matrix Multiplication
x = tf.constant([[1,2], [3,4]])
y = tf.constant([[1,1], [1,1]])

z = tf.matmul(x, y)

# Softmax Function
x = tf.constant([2.0, 1.0, 0.1])
print(tf.nn.softmax(x))

# Cross Entropy Example
softmax_data = [0.7, 0.2, 0.1]
one_hot_data = [1.0, 0.0, 0.0]

softmax = tf.constant(softmax_data)
one_hot = tf.constant(one_hot_data)

cross_entropy = -tf.reduce_sum(tf.multiply(one_hot, tf.math.log(softmax)))
print(cross_entropy)
</code></pre>
<pre><code>import tensorflow as tf

@tf.function
def func(x):
    return x

output = func(tf.constant('Hello World'))
print(output)
</code></pre>
<pre><code>import tensorflow as tf

# Tensor Creation Examples
string = tf.Variable(&quot;this is a string&quot;, tf.string)
number = tf.Variable(324, tf.int16)
floating = tf.Variable(3.567, tf.float32)

# Tensor Rank Examples
rank1_tensor = tf.Variable([&quot;Test&quot;], tf.string)
rank2_tensor = tf.Variable([[&quot;test&quot;, &quot;ok&quot;], [&quot;test&quot;, &quot;yes&quot;]], tf.string)

# Tensor Shape Examples
print(tf.rank(rank2_tensor))
print(tf.shape(rank2_tensor))

# Reshaping Tensors
t1 = tf.zeros([1,2,3])
t2 = tf.reshape(t1, [2,3,1])
t3 = tf.reshape(t2, [3,-1])

# Placeholder Example (TensorFlow 2.x does not have placeholders)
@tf.function
def func(x):
    return x

output = func(tf.constant('Hello World'))
print(output)

# Placeholder with feed_dict Example (Converted to TensorFlow 2.x)
@tf.function
def func(x, y, z):
    return x, y, z

output_x, output_y, output_z = func(tf.constant('Test String'), tf.constant(123), tf.constant(45.67))
print(output_x)
print(output_y)
print(output_z)

# TensorFlow Math Functions
x = tf.add(5, 2)
y = tf.subtract(10, 4)
z = tf.multiply(2, 5)

# Matrix Multiplication
x = tf.constant([[1,2], [3,4]])
y = tf.constant([[1,1], [1,1]])

z = tf.matmul(x, y)

# Softmax Function
x = tf.constant([2.0, 1.0, 0.1])
print(tf.nn.softmax(x))

# Cross Entropy Example
softmax_data = [0.7, 0.2, 0.1]
one_hot_data = [1.0, 0.0, 0.0]

softmax = tf.constant(softmax_data)
one_hot = tf.constant(one_hot_data)

cross_entropy = -tf.reduce_sum(tf.multiply(one_hot, tf.math.log(softmax)))
print(cross_entropy)
</code></pre>
<h2 id="tf-regression"><strong>TF regression</strong><a class="headerlink" href="#tf-regression" title="Permanent link">#</a></h2>
<h2 id="basic-regression-predict-fuel-efficiency"><strong>Basic regression: Predict fuel efficiency</strong><a class="headerlink" href="#basic-regression-predict-fuel-efficiency" title="Permanent link">#</a></h2>
<p>In a regression problem, the aim is to predict the output of a continuous value, like a price or a probability. Contrast this with a classification problem, where the aim is to select a class from a list of classes (for example, where a picture contains an apple or an orange, recognizing which fruit is in the picture).</p>
<p>This tutorial uses the classic Auto MPG dataset and demonstrates how to build models to predict the fuel efficiency of the late-1970s and early 1980s automobiles. To do this, you will provide the models with a description of many automobiles from that time period. This description includes attributes like cylinders, displacement, horsepower, and weight.</p>
<pre><code># Use seaborn for pairplot.
!pip install -q seaborn
</code></pre>
<pre><code>import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns

# Make NumPy printouts easier to read.
np.set_printoptions(precision=3, suppress=True)
</code></pre>
<pre><code>import tensorflow as tf

from tensorflow import keras
from tensorflow.keras import layers

print(tf.__version__)
</code></pre>
<h2 id="the-auto-mpg-dataset"><strong>The Auto MPG dataset</strong><a class="headerlink" href="#the-auto-mpg-dataset" title="Permanent link">#</a></h2>
<p>The dataset is available from the UCI Machine Learning Repository.
https://archive.ics.uci.edu/</p>
<p><strong>Get the data</strong></p>
<p>First download and import the dataset using pandas:</p>
<pre><code>url = 'http://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data'
column_names = ['MPG', 'Cylinders', 'Displacement', 'Horsepower', 'Weight',
                'Acceleration', 'Model Year', 'Origin']

raw_dataset = pd.read_csv(url, names=column_names,
                          na_values='?', comment='\t',
                          sep=' ', skipinitialspace=True)
</code></pre>
<pre><code>dataset = raw_dataset.copy()
dataset.tail()
</code></pre>
<p><strong>Clean the data</strong></p>
<p>The dataset contains a few unknown values:</p>
<pre><code>dataset.isna().sum()
</code></pre>
<p>Drop those rows to keep this initial tutorial simple:</p>
<pre><code>dataset = dataset.dropna()
</code></pre>
<p>The "Origin" column is categorical, not numeric. So the next step is to one-hot encode the values in the column with pd.get_dummies.</p>
<p>Note: You can set up the tf.keras.Model to do this kind of transformation for you but that's beyond the scope of this tutorial.</p>
<pre><code>dataset['Origin'] = dataset['Origin'].map({1: 'USA', 2: 'Europe', 3: 'Japan'})
</code></pre>
<pre><code>dataset = pd.get_dummies(dataset, columns=['Origin'], prefix='', prefix_sep='')
dataset.tail()
</code></pre>
<p><strong>Split the data into training and test sets:</strong></p>
<p>Now, split the dataset into a training set and a test set. You will use the test set in the final evaluation of your models.</p>
<pre><code>train_dataset = dataset.sample(frac=0.8, random_state=0)
test_dataset = dataset.drop(train_dataset.index)
</code></pre>
<p><strong>Inspect the data</strong></p>
<p>Review the joint distribution of a few pairs of columns from the training set.</p>
<p>The top row suggests that the fuel efficiency (MPG) is a function of all the other parameters. The other rows indicate they are functions of each other.</p>
<pre><code>sns.pairplot(train_dataset[['MPG', 'Cylinders', 'Displacement', 'Weight']], diag_kind='kde')
</code></pre>
<p><img alt="aiml" src="img/Picture50.png" /></p>
<pre><code>train_dataset.describe().transpose()
</code></pre>
<p><strong>Split features from labels</strong></p>
<p>Separate the target value—the "label"—from the features. This label is the value that you will train the model to predict.</p>
<pre><code>train_features = train_dataset.copy()
test_features = test_dataset.copy()

train_labels = train_features.pop('MPG')
test_labels = test_features.pop('MPG')
</code></pre>
<p><strong>Normalization</strong></p>
<p>In the table of statistics it's easy to see how different the ranges of each feature are:</p>
<pre><code>train_dataset.describe().transpose()[['mean', 'std']]
</code></pre>
<p>It is good practice to normalize features that use different scales and ranges.</p>
<p>One reason this is important is because the features are multiplied by the model weights. So, the scale of the outputs and the scale of the gradients are affected by the scale of the inputs.</p>
<p>Although a model might converge without feature normalization, normalization makes training much more stable.</p>
<p>Note: There is no advantage to normalizing the one-hot features—it is done here for simplicity. For more details on how to use the preprocessing layers, refer to the Working with preprocessing layers guide and the Classify structured data using Keras preprocessing layers tutorial.</p>
<p><strong>The Normalization layer</strong></p>
<p>The tf.keras.layers.Normalization is a clean and simple way to add feature normalization into your model.</p>
<p>The first step is to create the layer:</p>
<pre><code>normalizer = tf.keras.layers.Normalization(axis=-1)
</code></pre>
<p>Then, fit the state of the preprocessing layer to the data by calling Normalization.adapt:</p>
<pre><code>normalizer.adapt(np.array(train_features))
</code></pre>
<p>Calculate the mean and variance, and store them in the layer:</p>
<pre><code>print(normalizer.mean.numpy())
</code></pre>
<p>When the layer is called, it returns the input data, with each feature independently normalized:</p>
<pre><code>first = np.array(train_features[:1])

with np.printoptions(precision=2, suppress=True):
  print('First example:', first)
  print()
  print('Normalized:', normalizer(first).numpy())
</code></pre>
<h2 id="linear-regression"><strong>Linear regression</strong><a class="headerlink" href="#linear-regression" title="Permanent link">#</a></h2>
<p>Before building a deep neural network model, start with linear regression using one and several variables.</p>
<p><strong>Linear regression with one variable</strong></p>
<p>Begin with a single-variable linear regression to predict 'MPG' from 'Horsepower'.</p>
<p>Training a model with tf.keras typically starts by defining the model architecture. Use a tf.keras.Sequential model, which represents a sequence of steps.</p>
<p>There are two steps in your single-variable linear regression model:</p>
<ul>
<li>Normalize the 'Horsepower' input features using the tf.keras.layers.Normalization preprocessing layer.</li>
<li>Apply a linear transformation () to produce 1 output using a linear layer (tf.keras.layers.Dense).</li>
</ul>
<p>The number of inputs can either be set by the input_shape argument, or automatically when the model is run for the first time.</p>
<p>First, create a NumPy array made of the 'Horsepower' features. Then, instantiate the tf.keras.layers.Normalization and fit its state to the horsepower data:</p>
<pre><code>horsepower = np.array(train_features['Horsepower'])

horsepower_normalizer = layers.Normalization(input_shape=[1,], axis=None)
horsepower_normalizer.adapt(horsepower)
</code></pre>
<p>Build the Keras Sequential model:</p>
<pre><code>horsepower_model = tf.keras.Sequential([
    horsepower_normalizer,
    layers.Dense(units=1)
])

horsepower_model.summary()
</code></pre>
<p>This model will predict 'MPG' from 'Horsepower'
Run the untrained model on the first 10 'Horsepower' values. The output won't be good, but notice that it has the expected shape of (10, 1):</p>
<p>Once the model is built, configure the training procedure using the Keras Model.compile method. The most important arguments to compile are the loss and the optimizer, since these define what will be optimized (mean_absolute_error) and how (using the tf.keras.optimizers.Adam).</p>
<pre><code>horsepower_model.compile(
    optimizer=tf.keras.optimizers.Adam(learning_rate=0.1),
    loss='mean_absolute_error')
</code></pre>
<p>Use Keras Model.fit to execute the training for 100 epochs:</p>
<pre><code>%%time
history = horsepower_model.fit(
    train_features['Horsepower'],
    train_labels,
    epochs=100,
    # Suppress logging.
    verbose=0,
    # Calculate validation results on 20% of the training data.
    validation_split = 0.2)
</code></pre>
<p>Visualize the model's training progress using the stats stored in the history object:</p>
<pre><code>hist = pd.DataFrame(history.history)
hist['epoch'] = history.epoch
hist.tail()
</code></pre>
<pre><code>def plot_loss(history):
  plt.plot(history.history['loss'], label='loss')
  plt.plot(history.history['val_loss'], label='val_loss')
  plt.ylim([0, 10])
  plt.xlabel('Epoch')
  plt.ylabel('Error [MPG]')
  plt.legend()
  plt.grid(True)
</code></pre>
<pre><code>plot_loss(history)
</code></pre>
<p><img alt="aiml" src="img/Picture51.png" /></p>
<p>Collect the results on the test set for later:</p>
<pre><code>test_results = {}

test_results['horsepower_model'] = horsepower_model.evaluate(
    test_features['Horsepower'],
    test_labels, verbose=0)
</code></pre>
<pre><code>x = tf.linspace(0.0, 250, 251)
y = horsepower_model.predict(x)
</code></pre>
<pre><code>def plot_horsepower(x, y):
  plt.scatter(train_features['Horsepower'], train_labels, label='Data')
  plt.plot(x, y, color='k', label='Predictions')
  plt.xlabel('Horsepower')
  plt.ylabel('MPG')
  plt.legend()
</code></pre>
<p>Since this is a single variable regression, it's easy to view the model's predictions as a function of the input:</p>
<pre><code>def plot_horsepower(x, y):
  plt.scatter(train_features['Horsepower'], train_labels, label='Data')
  plt.plot(x, y, color='k', label='Predictions')
  plt.xlabel('Horsepower')
  plt.ylabel('MPG')
  plt.legend()
</code></pre>
<pre><code>plot_horsepower(x, y)
</code></pre>
<p><img alt="aiml" src="img/Picture52.png" /></p>
<h2 id="linear-regression-with-multiple-inputs"><strong>Linear regression with multiple inputs</strong><a class="headerlink" href="#linear-regression-with-multiple-inputs" title="Permanent link">#</a></h2>
<p>You can use an almost identical setup to make predictions based on multiple inputs. This model still does the same y = mx + b except that m is a matrix and x is a vector.</p>
<p>Create a two-step Keras Sequential model again with the first layer being normalizer (tf.keras.layers.Normalization(axis=-1)) you defined earlier and adapted to the whole dataset:</p>
<pre><code>linear_model = tf.keras.Sequential([
    normalizer,
    layers.Dense(units=1)
])
</code></pre>
<p>When you call Model.predict on a batch of inputs, it produces units=1 outputs for each example:</p>
<pre><code>linear_model.predict(train_features[:10])
</code></pre>
<p>When you call the model, its weight matrices will be built—check that the kernel weights (the m in y  = mx + b) have a shape (9, 1)</p>
<pre><code>linear_model.layers[1].kernel
</code></pre>
<p>Configure the model with Keras Model.compile and train with Model.fit for 100 epochs:</p>
<pre><code>linear_model.compile(
    optimizer=tf.keras.optimizers.Adam(learning_rate=0.1),
    loss='mean_absolute_error')
</code></pre>
<pre><code>%%time
history = linear_model.fit(
    train_features,
    train_labels,
    epochs=100,
    # Suppress logging.
    verbose=0,
    # Calculate validation results on 20% of the training data.
    validation_split = 0.2)
</code></pre>
<p>Using all the inputs in this regression model achieves a much lower training and validation error than the horsepower_model, which had one input:</p>
<p>plot_loss(history)</p>
<p><img alt="aiml" src="img/Picture53.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="Keras.html" class="btn btn-neutral float-left" title="Keras"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="Pytorch.html" class="btn btn-neutral float-right" title="Pytorch">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ganesh-document/all-documents" class="fa fa-code-fork" style="color: #fcfcfc"> Ganesh All Documents</a>
        </span>
    
    
      <span><a href="Keras.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="Pytorch.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
