name: ganesh-document/all-documents
on:
  repository_dispatch:
    types: do-build
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
env:
  GHE_TOKEN: ${{ secrets.GHE_TOKEN }}
  ACTIONS_ALLOW_UNSECURE_COMMANDS: true
  WORKSPACE_PATH: ${{ github.workspace }}
  REPO: ${{ github.repository }}
jobs:
  build:
    name: build
    runs-on: [ ubuntu-latest ]
    steps:
    - name: Set up Python 3.x environment on the runner
      run: |
        sudo apt install python3.9
    - name: Make docs
      run: |
        pip install jinja2==3.0.3
        pip install mkdocs
        pip install mkdocs-material
        pip install mkdocs-git-revision-date-localized-plugin
        mkdocs build --verbose --clean
    - name: Publish docs
      if: github.ref == 'refs/heads/master'
      run: |
        git fetch
        mkdocs gh-deploy
